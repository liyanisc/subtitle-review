WEBVTT

00:00:00.000 --> 00:00:01.070 align:middle line:90%


00:00:01.070 --> 00:00:03.080 align:middle line:84%
欢迎来到 eLearning 课程

00:00:03.080 --> 00:00:08.160 align:middle line:84%
Ensemble 入门,业务流程(Business Process)概述


00:00:08.160 --> 00:00:10.180 align:middle line:84%
这课程会描述使用基本

00:00:10.180 --> 00:00:13.900 align:middle line:84%
业务流程语言，BPL 以协调

00:00:13.900 --> 00:00:16.990 align:middle line:84%
调用外部应用，根据响应

00:00:16.990 --> 00:00:20.360 align:middle line:84%
采取对应行动，以及创建一个长期

00:00:20.360 --> 00:00:21.600 align:middle line:90%
运营的业务流程。

00:00:21.600 --> 00:00:24.190 align:middle line:84%
它可自动化处理有人执行的

00:00:24.190 --> 00:00:29.300 align:middle line:84%
牵涉多个系统的任务。


00:00:29.300 --> 00:00:31.690 align:middle line:84%
这不仅是一个编程环境。

00:00:31.690 --> 00:00:33.800 align:middle line:84%
The responses may
come back immediately,
响应消息可以是实时的，

00:00:33.800 --> 00:00:37.110 align:middle line:84%
或者可能需要等某些外部事件做出响应。

00:00:37.110 --> 00:00:39.340 align:middle line:84%
比如，在一个业务流程中，

00:00:39.340 --> 00:00:42.130 align:middle line:84%
也许需要等待某人的批准，或者一个订单

00:00:42.130 --> 00:00:45.010 align:middle line:84%
需要等待货物进库。

00:00:45.010 --> 00:00:47.170 align:middle line:84%
这也许需要等待几个小时，甚至几天。

00:00:47.170 --> 00:00:50.300 align:middle line:84%
并且该业务流程能在中断处继续下去。

00:00:50.300 --> 00:00:52.850 align:middle line:84%
一个业务流程可以保持它的状态，

00:00:52.850 --> 00:00:54.845 align:middle line:90%
甚至在系统重起后。

00:00:54.845 --> 00:00:57.840 align:middle line:90%


00:00:57.840 --> 00:01:00.570 align:middle line:84%
Ensemble 的图形化的 BPL 编辑器

00:01:00.570 --> 00:01:03.624 align:middle line:84%
以可视化方式显示和编辑一个业务流程，

00:01:03.624 --> 00:01:06.840 align:middle line:84%
如同流程图一样，

00:01:06.840 --> 00:01:09.190 align:middle line:84%
各个活动间有连线相连。


00:01:09.190 --> 00:01:11.390 align:middle line:84%
各个活动的具体情况可在

00:01:11.390 --> 00:01:14.510 align:middle line:84%
BPL 编辑器点击获取。

00:01:14.510 --> 00:01:18.600 align:middle line:84%
业务流程然后可以加入到 Ensemble Production,

00:01:18.600 --> 00:01:23.570 align:middle line:84%
被业务服务(BS)或者另一个业务流程(BP)

00:01:23.570 --> 00:01:24.740 align:middle line:90%
Process.
调用

00:01:24.740 --> 00:01:27.880 align:middle line:84%
一个新的业务流程可以通过管理门户

00:01:27.880 --> 00:01:32.030 align:middle line:84%
或者 Ensemble 的 Studio 中写 BPL 创建。

00:01:32.030 --> 00:01:35.180 align:middle line:84%
让我们到管理门户的 BPL 编辑去。

00:01:35.180 --> 00:01:40.500 align:middle line:84%
我们点击 Ensemble, Build, Business Process.

00:01:40.500 --> 00:01:43.360 align:middle line:90%


00:01:43.360 --> 00:01:46.160 align:middle line:84%
我们点击新建(New) 按钮创建

00:01:46.160 --> 00:01:49.420 align:middle line:84%
创建一个新的业务流程，这里

00:01:49.420 --> 00:01:55.761 align:middle line:84%
会给我们弹出一个对话框，需填入

00:01:55.761 --> 00:01:56.260 align:middle line:90%
业务流程的包名和名称。

00:01:56.260 --> 00:02:04.700 align:middle line:90%


00:02:04.700 --> 00:02:08.850 align:middle line:84%
当我们点击 OK, 你会看到，我们有业务流程的

00:02:08.850 --> 00:02:15.270 align:middle line:84%
一个开始和结束活动标志。

00:02:15.270 --> 00:02:19.960 align:middle line:84%
在 General 标签页，你可以看到

00:02:19.960 --> 00:02:23.510 align:middle line:90%
该业务流程的一般信息

00:02:23.510 --> 00:02:30.570 align:middle line:84%
在 Context 标签，你可以指定 Request 和 Response

00:02:30.570 --> 00:02:34.620 align:middle line:84%
消息，他们是发送到业务流程和从业务流程处返回的消息。

00:02:34.620 --> 00:02:36.530 align:middle line:84%
它也允许你加属性到

00:02:36.530 --> 00:02:38.510 align:middle line:90%
上下文对象中。

00:02:38.510 --> 00:02:43.120 align:middle line:84%
我会过一会儿详细解释 Context.

00:02:43.120 --> 00:02:46.700 align:middle line:84%
一个业务流程通常由一个从业务服务处来的 Request 消息

00:02:46.700 --> 00:02:49.290 align:middle line:84%
调用。

00:02:49.290 --> 00:02:51.420 align:middle line:90%
或者消息来之另一个业务流程。

00:02:51.420 --> 00:02:54.990 align:middle line:84%
这个消息被称之为主请求消息(primary request).

00:02:54.990 --> 00:02:56.960 align:middle line:84%
在一个业务流程中，这个消息

00:02:56.960 --> 00:03:00.950 align:middle line:84%
可以作为一个 request 对象被访问。

00:03:00.950 --> 00:03:03.610 align:middle line:84%
如果业务流程返回一个 response,

00:03:03.610 --> 00:03:06.600 align:middle line:84%
那么它被称为主返回消息(primary response),

00:03:06.600 --> 00:03:11.150 align:middle line:84%
可以通过 response 对象被访问。

00:03:11.150 --> 00:03:14.440 align:middle line:84%
primary request 和 primary response

00:03:14.440 --> 00:03:17.300 align:middle line:84%
在 Context 标签页中配置，

00:03:17.300 --> 00:03:21.050 align:middle line:84%
他们属性能为该业务流程中

00:03:21.050 --> 00:03:24.240 align:middle line:90%
所有的活动所用。

00:03:24.240 --> 00:03:28.970 align:middle line:84%
然后你可以通过点击 "Add Activity"，并选择活动，

00:03:28.970 --> 00:03:31.620 align:middle line:84%
添加一个新活动。

00:03:31.620 --> 00:03:37.130 align:middle line:84%
比如，如果我希望调用另外一个业务流程，

00:03:37.130 --> 00:03:40.350 align:middle line:84%
或者另外一个业务操作(Business Operation),

00:03:40.350 --> 00:03:42.600 align:middle line:90%
我会增加一个调用动作。

00:03:42.600 --> 00:03:44.780 align:middle line:84%
在 Activity 标签页，我可以填入

00:03:44.780 --> 00:03:50.860 align:middle line:84%
具体的发送消息和返回消息类型。

00:03:50.860 --> 00:04:01.960 align:middle line:84%
然后，可以将这个动作链接起来，

00:04:01.960 --> 00:04:03.370 align:middle line:90%
形成一个完整的流程图。

00:04:03.370 --> 00:04:09.830 align:middle line:90%


00:04:09.830 --> 00:04:13.550 align:middle line:84%
当一个基于 BPL 的业务流程开始的时，

00:04:13.550 --> 00:04:16.730 align:middle line:84%
response 对象会自动创建。

00:04:16.730 --> 00:04:20.190 align:middle line:84%
但是，设置这个 response 的属性，


00:04:20.190 --> 00:04:23.560 align:middle line:84%
是业务流程的职责。


00:04:23.560 --> 00:04:26.280 align:middle line:84%
在执行业务流程时，

00:04:26.280 --> 00:04:28.910 align:middle line:84%
你也许需要存储一些

00:04:28.910 --> 00:04:33.330 align:middle line:84%
primary request 或是 primary response 的非属性值，

00:04:33.330 --> 00:04:35.490 align:middle line:90%
其将在以后被用到。

00:04:35.490 --> 00:04:39.320 align:middle line:84%
这些值应该被保存在 Context 对象的属性中，

00:04:39.320 --> 00:04:45.080 align:middle line:84%
它们需要在 Context  标签页中保存。

00:04:45.080 --> 00:04:49.100 align:middle line:84%
大部分的业务流程需要使用Context属性。

00:04:49.100 --> 00:04:52.530 align:middle line:84%
你可以简单地加变量属性到 Context

00:04:52.530 --> 00:04:56.830 align:middle line:84%
对象，或者你可以将属性定义成

00:04:56.830 --> 00:04:59.470 align:middle line:90%
serial or persistent objects.
serial对象，或者是持久化对象。

00:04:59.470 --> 00:05:04.150 align:middle line:84%
比如，如果我需要定义个临时的客户 ID，

00:05:04.150 --> 00:05:07.530 align:middle line:84%
我可以添加一个字串属性 CustomerID,

00:05:07.530 --> 00:05:10.160 align:middle line:84%
通过点击 "+" 标记，添加具体信息。

00:05:10.160 --> 00:05:22.780 align:middle line:90%


00:05:22.780 --> 00:05:27.930 align:middle line:84%
我们添加了一个 Context 属性。

00:05:27.930 --> 00:05:30.930 align:middle line:84%
在业务流程的不同点上，执行，

00:05:30.930 --> 00:05:33.400 align:middle line:84%
停止，和陈述业务流程的状态，

00:05:33.400 --> 00:05:37.760 align:middle line:84%
包括, request, context 以及 response 对象

00:05:37.760 --> 00:05:39.580 align:middle line:90%
都保存在磁盘上。

00:05:39.580 --> 00:05:41.720 align:middle line:84%
当业务流程再次被唤醒时，

00:05:41.720 --> 00:05:46.610 align:middle line:84%
这些对象重新打开，但是那些本地变量却已丢失。

00:05:46.610 --> 00:05:49.440 align:middle line:90%


00:05:49.440 --> 00:05:53.260 align:middle line:84%
让我们来看一下业务流程的一个实际例子。

00:05:53.260 --> 00:05:56.880 align:middle line:84%
这个业务流程用于一个在线订购系统

00:05:56.880 --> 00:05:59.820 align:middle line:84%
其回调用一个库存系统，订单处理系统，

00:05:59.820 --> 00:06:02.100 align:middle line:84%
以及一个报价数据库。

00:06:02.100 --> 00:06:06.530 align:middle line:84%
让我们看一下这个业务流程。

00:06:06.530 --> 00:06:12.270 align:middle line:84%
其 primary request 和 primary response

00:06:12.270 --> 00:06:16.730 align:middle line:84%
被定义成一 订单 request 和一订单 response.

00:06:16.730 --> 00:06:19.650 align:middle line:84%
我们还有几个 context 属性

00:06:19.650 --> 00:06:24.500 align:middle line:84%
因而，我们可以在一些指定的调用中使用它们。

00:06:24.500 --> 00:06:28.840 align:middle line:84%
当订单 request 达到业务流程是，

00:06:28.840 --> 00:06:33.040 align:middle line:84%
我们调用 CheckInventory 以检查

00:06:33.040 --> 00:06:35.060 align:middle line:90%
是否有足够的库存。

00:06:35.060 --> 00:06:38.080 align:middle line:84%
如果库存足够，我么下订单，比检查价格，

00:06:38.080 --> 00:06:41.540 align:middle line:84%
并产生 reponse, 检查是否需要进货，然后结束。

00:06:41.540 --> 00:06:46.030 align:middle line:84%
如果没有足够库存，那么拒绝订单，

00:06:46.030 --> 00:06:48.470 align:middle line:84%
并产生一个响应的 response

00:06:48.470 --> 00:06:51.270 align:middle line:84%
同时结束这个业务流程。

00:06:51.270 --> 00:06:54.890 align:middle line:90%


00:06:54.890 --> 00:06:58.140 align:middle line:84%
您刚才收看的 Ensemble 入门，

00:06:58.140 --> 00:07:01.290 align:middle line:90%
业务流程概述。

00:07:01.290 --> 00:07:02.604 align:middle line:90%
